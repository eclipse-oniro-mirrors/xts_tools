/*
 * Copyright (c) 2025 Shenzhen Kaihong Digital Industry Development Co., Ltd.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

import router from '@ohos.router';
import hilog from '@ohos.hilog';

@Entry
@Component
struct AceActionEventCommonEventAxisEventsListen01 {
  @State operationLog: string[] = [];
  @State inputText: string = 'è¯·åœ¨æ­¤è¾“å…¥æ¡†ä¸Šæ»šåŠ¨é¼ æ ‡';
  @State actionValue: string = 'ç­‰å¾…é¼ æ ‡æ»šåŠ¨...';
  @State actionValueColor: Color = Color.Grey;
  @State scrollEventCount: number = 0;
  @State beginEventCount: number = 0;

  aboutToAppear() {
    hilog.info(0x0000, 'testTag', '=== Index é¡µé¢åŠ è½½ ===');
    this.addLog('Index é¡µé¢å·²åŠ è½½');
    this.addLog('å‡†å¤‡ç›‘å¬é¼ æ ‡æ»šåŠ¨äº‹ä»¶');
  }

  addLog(message: string) {
    const timestamp = new Date().toLocaleTimeString();
    const log = `[${timestamp}] ${message}`;
    this.operationLog.unshift(log);
    if (this.operationLog.length > 15) {
      this.operationLog.pop();
    }
    hilog.info(0x0000, 'testTag', log);
  }

  build() {
    Column({ space: 12 })
    {
      // æ ‡é¢˜åŒºåŸŸ
      Column({ space: 4 }) {
        Text('é¼ æ ‡æ»šåŠ¨è½´äº‹ä»¶ç›‘å¬æµ‹è¯•')
          .fontSize(20)
          .fontWeight(FontWeight.Bold)
          .fontColor('#FFFFFF')
          .width('100%')
          .textAlign(TextAlign.Center)

        Text('SUB_ACE_ACTION_EVENT_COMMONEVENT_AXIS_EVENTS_LISTEN_001')
          .fontSize(9)
          .fontColor('#FFD700')
          .fontFamily('Courier')
          .width('100%')
          .textAlign(TextAlign.Center)
      }
      .width('100%')
      .padding(15)
      .backgroundColor('#2196F3')

      Scroll() {
        Column({ space: 12 }) {
          // å½“å‰é¡µé¢æ ‡è¯†
          Column({ space: 5 }) {
            Text('ğŸ“„ æµ‹è¯•é¡µé¢')
              .fontSize(12)
              .fontWeight(FontWeight.Bold)
              .fontColor('#182431')

            Text('éªŒè¯é¼ æ ‡å¼€å§‹æ»šåŠ¨æ—¶è§¦å‘ BEGIN')
              .fontSize(16)
              .fontWeight(FontWeight.Bold)
              .fontColor('#FFFFFF')
              .width('100%')
              .padding(12)
              .backgroundColor('#2196F3')
              .borderRadius(8)
              .textAlign(TextAlign.Center)
          }
          .width('94%')
          .alignItems(HorizontalAlign.Start)

          // æµ‹è¯•æŒ‰é’®åŒºåŸŸ
          Column({ space: 5 }) {
            Text('ğŸ–±ï¸ æµ‹è¯•åŒºåŸŸ1ï¼ˆåœ¨æŒ‰é’®ä¸Šæ»šåŠ¨é¼ æ ‡ï¼‰')
              .fontSize(12)
              .fontWeight(FontWeight.Bold)
              .fontColor('#182431')

            Button('AxisEvent æµ‹è¯•æŒ‰é’®\nè¯·åœ¨æ­¤æŒ‰é’®ä¸Šæ»šåŠ¨é¼ æ ‡')
              .width('100%')
              .height(100)
              .fontSize(16)
              .backgroundColor('#2196F3')
              .fontColor('#FFFFFF')
              .id('AceActionEventCommonEventAxisEventsListen01')
              .fontWeight(FontWeight.Bold)
              .onAxisEvent((event?: AxisEvent) => {
                if (event) {
                  const action = event.action;
                  let actionName = '';
                  switch (action) {
                    case 1:
                      actionName = 'BEGIN';
                      this.actionValue = `actionValue = ${action} (BEGIN) âœ“`;
                      this.actionValueColor = Color.Green;
                      this.beginEventCount++;
                      this.addLog(`âœ“âœ“âœ“ [æŒ‰é’®] æ•è·åˆ° BEGIN äº‹ä»¶ï¼ŒactionValue = ${action}`);
                      hilog.info(0x0000, 'testTag', `[å…³é”®å­—actionValue] è½´äº‹ä»¶å¼€å§‹ BEGIN: actionValue = ${action}`);
                      break;
                    case 2:
                      actionName = 'UPDATE';
                      this.actionValue = `actionValue = ${action} (UPDATE)`;
                      this.actionValueColor = Color.Orange;
                      this.addLog(`[æŒ‰é’®] è½´äº‹ä»¶æ›´æ–° UPDATE: actionValue = ${action}`);
                      hilog.info(0x0000, 'testTag', `è½´äº‹ä»¶æ›´æ–°: actionValue = ${action}`);
                      break;
                    case 3:
                      actionName = 'END';
                      this.actionValue = `actionValue = ${action} (END)`;
                      this.actionValueColor = Color.Blue;
                      this.addLog(`[æŒ‰é’®] è½´äº‹ä»¶ç»“æŸ END: actionValue = ${action}`);
                      hilog.info(0x0000, 'testTag', `è½´äº‹ä»¶ç»“æŸ: actionValue = ${action}`);
                      break;
                    case 4:
                      actionName = 'CANCEL';
                      this.actionValue = `actionValue = ${action} (CANCEL)`;
                      this.actionValueColor = Color.Red;
                      this.addLog(`[æŒ‰é’®] è½´äº‹ä»¶å–æ¶ˆ CANCEL: actionValue = ${action}`);
                      hilog.info(0x0000, 'testTag', `è½´äº‹ä»¶å–æ¶ˆ: actionValue = ${action}`);
                      break;
                    default:
                      actionName = `UNKNOWN(${action})`;
                      this.actionValue = `actionValue = ${action}`;
                      this.actionValueColor = Color.Grey;
                      this.addLog(`[æŒ‰é’®] æœªçŸ¥è½´äº‹ä»¶: actionValue = ${action}`);
                      break;
                  }
                  const verticalValue = event.getVerticalAxisValue();
                  const horizontalValue = event.getHorizontalAxisValue();
                  this.scrollEventCount++;
                  const detailLog = `[æŒ‰é’®] AxisEvent: action=${action}(${actionName}), ` +
                    `x=${event.x}, y=${event.y}, ` +
                    `windowX=${event.windowX}, windowY=${event.windowY}, ` +
                    `displayX=${event.displayX}, displayY=${event.displayY}, ` +
                    `verticalAxis=${verticalValue}, horizontalAxis=${horizontalValue}`;
                  hilog.info(0x0000, 'testTag', detailLog);
                  if (action === 1) {
                    this.addLog(`[æŒ‰é’®] åæ ‡: (${event.x.toFixed(2)}, ${event.y.toFixed(2)})`);
                    this.addLog(`[æŒ‰é’®] å‚ç›´è½´å€¼: ${verticalValue.toFixed(2)}, æ°´å¹³è½´å€¼: ${horizontalValue.toFixed(2)}`);
                  }
                }
              })
          }
          .width('94%')
          .alignItems(HorizontalAlign.Start)

          Column({ space: 5 }) {
            Text('âš¡ ActionValue çŠ¶æ€')
              .fontSize(12)
              .fontWeight(FontWeight.Bold)
              .fontColor('#182431')

            Text(this.actionValue)
              .fontSize(16)
              .fontColor(this.actionValueColor)
              .fontWeight(FontWeight.Bold)
              .width('100%')
              .padding(15)
              .backgroundColor('#FFF9C4')
              .borderRadius(8)
              .textAlign(TextAlign.Center)
              .border({ width: 3, color: this.actionValueColor })
          }
          .width('94%')
          .alignItems(HorizontalAlign.Start)

          // äº‹ä»¶ç»Ÿè®¡
          Column({ space: 5 }) {
            Text('ğŸ“Š äº‹ä»¶ç»Ÿè®¡')
              .fontSize(12)
              .fontWeight(FontWeight.Bold)
              .fontColor('#182431')

            Column({ space: 8 }) {
              Row({ space: 10 }) {
                Text('BEGIN äº‹ä»¶æ¬¡æ•°:')
                  .fontSize(13)
                  .fontColor('#666666')
                Text(`${this.beginEventCount}`)
                  .fontSize(16)
                  .fontColor('#4CAF50')
                  .fontWeight(FontWeight.Bold)
              }
              .width('100%')
              .justifyContent(FlexAlign.SpaceBetween)

              Row({ space: 10 }) {
                Text('æ€»æ»šåŠ¨äº‹ä»¶æ¬¡æ•°:')
                  .fontSize(13)
                  .fontColor('#666666')
                Text(`${this.scrollEventCount}`)
                  .fontSize(16)
                  .fontColor('#2196F3')
                  .fontWeight(FontWeight.Bold)
              }
              .width('100%')
              .justifyContent(FlexAlign.SpaceBetween)
            }
            .width('100%')
            .padding(12)
            .backgroundColor('#E8F5E9')
            .borderRadius(8)
          }
          .width('94%')
          .alignItems(HorizontalAlign.Start)

          // æ“ä½œæ—¥å¿—
          Column({ space: 5 }) {
            Text('ğŸ“‹ äº‹ä»¶æ—¥å¿—')
              .fontSize(12)
              .fontWeight(FontWeight.Bold)
              .fontColor('#182431')

            Scroll() {
              Column({ space: 2 }) {
                if (this.operationLog.length > 0) {
                  ForEach(this.operationLog, (log: string, index: number) => {
                    Text(log)
                      .fontSize(10)
                      .fontColor(log.includes('âœ“') ? '#4CAF50' :
                        log.includes('BEGIN') ? '#2E7D32' : '#666666')
                      .fontFamily('Courier')
                      .width('100%')
                      .padding(5)
                      .backgroundColor(index % 2 === 0 ? '#F5F5F5' : '#FFFFFF')
                  }, (log: string, index: number) => `${index}_${log}`)
                } else {
                  Text('æš‚æ— äº‹ä»¶æ—¥å¿—')
                    .fontSize(10)
                    .fontColor('#999999')
                    .width('100%')
                    .textAlign(TextAlign.Center)
                    .padding(8)
                }
              }
              .width('100%')
            }
            .width('100%')
            .height(250)
            .backgroundColor('#FAFAFA')
            .borderRadius(6)
            .border({ width: 1, color: '#E0E0E0' })
            .scrollBar(BarState.Auto)
          }
          .width('94%')
          .alignItems(HorizontalAlign.Start)

          // æµ‹è¯•è¯´æ˜
          Column({ space: 5 }) {
            Text('ğŸ“ æµ‹è¯•è¯´æ˜ä¸é¢„æœŸç»“æœ')
              .fontSize(12)
              .fontWeight(FontWeight.Bold)
              .fontColor('#182431')

            Column({ space: 4 }) {
              Text('ğŸ¯ æµ‹è¯•æ­¥éª¤ï¼š')
                .fontSize(11)
                .fontColor('#2196F3')
                .fontWeight(FontWeight.Bold)
                .width('100%')

              Text('1ï¸âƒ£ åœ¨æŒ‰é’®æˆ–è¾“å…¥æ¡†ä¸Šä½¿ç”¨é¼ æ ‡æ»šè½®æ»šåŠ¨')
                .fontSize(11)
                .fontColor('#666666')
                .width('100%')
                .margin({ left: 10 })

              Text('2ï¸âƒ£ è§‚å¯Ÿ ActionValue çŠ¶æ€æ˜¾ç¤º')
                .fontSize(11)
                .fontColor('#666666')
                .width('100%')
                .margin({ left: 10 })

              Text('3ï¸âƒ£ æŸ¥çœ‹äº‹ä»¶æ—¥å¿—ä¸­çš„å…³é”®å­— actionValue')
                .fontSize(11)
                .fontColor('#666666')
                .width('100%')
                .margin({ left: 10 })

              Divider().margin({ top: 5, bottom: 5 })

              Text('âœ… é¢„æœŸç»“æœï¼š')
                .fontSize(11)
                .fontColor('#4CAF50')
                .fontWeight(FontWeight.Bold)
                .width('100%')

              Text('â€¢ è½´äº‹ä»¶å¼€å§‹æ—¶è¿”å› BEGIN')
                .fontSize(11)
                .fontColor('#4CAF50')
                .fontWeight(FontWeight.Bold)
                .width('100%')
                .margin({ left: 10 })

              Text('â€¢ æ—¥å¿—ä¸­è¿”å›æ•°å­— 1')
                .fontSize(11)
                .fontColor('#4CAF50')
                .fontWeight(FontWeight.Bold)
                .width('100%')
                .margin({ left: 10 })

              Text('â€¢ hilog åŒ…å« [å…³é”®å­—actionValue]')
                .fontSize(11)
                .fontColor('#4CAF50')
                .fontWeight(FontWeight.Bold)
                .width('100%')
                .margin({ left: 10 })

              Divider()
                .margin({ top: 5, bottom: 5 })

              Text('ğŸ“Œ AxisAction æšä¸¾å€¼ï¼š')
                .fontSize(10)
                .fontColor('#666666')
                .fontWeight(FontWeight.Bold)
                .width('100%')

              Text('  BEGIN = 1   (è½´äº‹ä»¶å¼€å§‹) âœ“')
                .fontSize(10)
                .fontColor('#4CAF50')
                .fontFamily('Courier')
                .fontWeight(FontWeight.Bold)
                .width('100%')
                .margin({ left: 5 })

              Text('  UPDATE = 2  (è½´äº‹ä»¶æ›´æ–°)')
                .fontSize(10)
                .fontColor('#FF9800')
                .fontFamily('Courier')
                .width('100%')
                .margin({ left: 5 })

              Text('  END = 3     (è½´äº‹ä»¶ç»“æŸ)')
                .fontSize(10)
                .fontColor('#2196F3')
                .fontFamily('Courier')
                .width('100%')
                .margin({ left: 5 })

              Text('  CANCEL = 4  (è½´äº‹ä»¶å–æ¶ˆ)')
                .fontSize(10)
                .fontColor('#F44336')
                .fontFamily('Courier')
                .width('100%')
                .margin({ left: 5 })

              Divider().margin({ top: 5, bottom: 5 })

              Text('ğŸ’¡ æç¤ºï¼š')
                .fontSize(10)
                .fontColor('#FF9800')
                .fontWeight(FontWeight.Bold)
                .width('100%')

              Text('æ»šåŠ¨ä¸€æ¬¡é€šå¸¸ä¼šè§¦å‘ï¼šBEGIN â†’ UPDATE(å¤šæ¬¡) â†’ END')
                .fontSize(10)
                .fontColor('#666666')
                .fontStyle(FontStyle.Italic)
                .width('100%')
                .margin({ left: 10 })
            }
            .width('100%')
            .padding(10)
            .backgroundColor('#E3F2FD')
            .borderRadius(6)
            .alignItems(HorizontalAlign.Start)
          }
          .width('94%')
          .alignItems(HorizontalAlign.Start)

        }
        .width('100%')
        .padding({ left: 10, right: 10, bottom: 10 })
      }
      .layoutWeight(1)
      .scrollBar(BarState.Auto)

    }
    .width('100%')
    .height('100%')
    .backgroundColor('#FAFAFA')
  }
}
