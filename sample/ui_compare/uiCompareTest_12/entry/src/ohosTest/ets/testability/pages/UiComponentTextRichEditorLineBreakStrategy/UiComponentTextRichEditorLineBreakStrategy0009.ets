/**
 * Copyright (c) 2025 Shenzhen Kaihong Digital Industry Development Co., Ltd.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

@Entry
@Component
struct UiComponentTextRichEditorLineBreakStrategy0009 {
  controller: RichEditorController = new RichEditorController();
  private spanParagraphs: RichEditorParagraphResult[] = [];
  @State lineBreakOptionStr: string[] = ['GREEDY', 'HIGH_QUALITY', 'BALANCED'];
  @State attributeValue: string = "";
  
  // æµ‹è¯•æ–‡æœ¬ï¼šåŒ…å«Non-CJKæ–‡æœ¬(è‹±æ–‡)ã€CJKæ–‡æœ¬(ä¸­æ–‡ã€æ—¥æ–‡ã€éŸ©æ–‡)ã€æ•°å­—ã€ç‰¹æ®Šç¬¦å·ã€è¡¨æƒ…
  @State testStr: string = "Good Morning! æ—©ä¸Šå¥½ï¼ãŠã¯ã‚ˆã†ã”ã–ã„ã¾ã™ï¼ì¢‹ì€ ì•„ì¹¨ìž…ë‹ˆë‹¤! 11111 ~!@#$%^&*() ðŸš€ðŸŽªðŸŽ­";

  build() {
    Column() {
      // RichEditorç»„ä»¶ï¼šè®¾ç½®lineBreakStrategyä¸ºGREEDYï¼Œè§‚å¯ŸæŠ˜è¡Œæ•ˆæžœ
      RichEditor({ controller: this.controller })
        .onReady(() => {
          // æ·»åŠ æ··åˆå†…å®¹æ–‡æœ¬ï¼Œæµ‹è¯•GREEDYç­–ç•¥çš„æŠ˜è¡Œæ•ˆæžœ
          this.controller.addTextSpan(this.testStr, {
            style: {
              fontColor: Color.Black,
              fontSize: "20"
            },
            paragraphStyle: {
              textAlign: TextAlign.Start,
              lineBreakStrategy: LineBreakStrategy.GREEDY  // åˆå§‹ç­–ç•¥ï¼šGREEDY
            }
          })
        })
        .id("rich_editor_linebreakstrategy_0009")
        .width(500)
        .height(300)
        .margin({bottom:20})
        .draggable(false)
        .backgroundColor('#f0f8ff')
        .borderRadius(16)
        .padding(24)
      
      // æ˜¾ç¤ºå½“å‰linebreakå±žæ€§å€¼
      Column(){
        Text('linebreakå±žæ€§å€¼ä¸ºï¼š' + this.attributeValue).fontSize(20).fontColor(Color.Black)
      }.margin({bottom: 10})
      
      // æŒ‰é’®æŽ§åˆ¶åŒºåŸŸ
      Column({ space: 10 }) {
        // æ­¥éª¤1ï¼šå…ˆè®¾ç½®éžå½“å‰æµ‹è¯•ç­–ç•¥ï¼ˆHIGH_QUALITYï¼‰ï¼Œç”¨äºŽå¯¹æ¯”æµ‹è¯•
        Button("è®¾ç½®HIGH_QUALITYç­–ç•¥ï¼ˆå¯¹æ¯”æµ‹è¯•ï¼‰")
          .id("button_linebreakstrategy_0009_setHighQuality")
          .width("80%")
          .onClick(() => {
            // è®¾ç½®HIGH_QUALITYç­–ç•¥ä½œä¸ºå¯¹æ¯”
            this.controller.updateParagraphStyle({ start: -1, end: -1,
              style: {
                lineBreakStrategy: LineBreakStrategy.HIGH_QUALITY
              }
            })
          })
        
        // æ­¥éª¤2ï¼šåˆ‡æ¢åˆ°å½“å‰è¦æµ‹è¯•çš„GREEDYç­–ç•¥
        Button("åˆ‡æ¢åˆ°GREEDYç­–ç•¥ï¼ˆæµ‹è¯•ç›®æ ‡ï¼‰")
          .id("button_linebreakstrategy_0009_testGreedy")
          .width("80%")
          .onClick(() => {
            // åˆ‡æ¢åˆ°GREEDYç­–ç•¥ï¼Œè§‚å¯ŸæŠ˜è¡Œæ•ˆæžœ
            this.controller.updateParagraphStyle({ start: -1, end: -1,
              style: {
                lineBreakStrategy: LineBreakStrategy.GREEDY
              }
            })
          })
        
        Divider()
        
        // æ­¥éª¤3ï¼šèŽ·å–å½“å‰linebreakå±žæ€§å€¼ï¼Œç”¨äºŽéªŒè¯ç­–ç•¥è®¾ç½®æ˜¯å¦æˆåŠŸ
        Row(){
          Button("èŽ·å–linebreakå±žæ€§å€¼")
            .id("button_linebreakstrategy_0009_getAttribute")
            .width("80%")
            .onClick(() => {
              this.spanParagraphs = this.controller.getParagraphs({ start: -1, end: -1 });
              console.info("RichEditor getParagraphs:" + JSON.stringify(this.spanParagraphs));
              this.spanParagraphs.forEach(item => {
                if(typeof(item as RichEditorParagraphResult)['style'] != 'undefined'){
                  this.attributeValue = "";
                  console.info('lineBreakStrategy:'+ JSON.stringify((item as RichEditorParagraphResult)['style']));
                  this.attributeValue += this.lineBreakOptionStr[Number((item as RichEditorParagraphResult)['style'].lineBreakStrategy)];
                }
              })
            })
        }
      }
    }
  }
}
